import React, { useState } from 'react';
import { 
  School,
  Building,
  Users,
  MapPin,
  Phone,
  Mail,
  Globe,
  Calendar,
  Plus,
  Search,
  Filter,
  Edit,
  Eye,
  MoreVertical,
  CheckCircle,
  AlertTriangle,
  Clock,
  UserCheck,
  GraduationCap,
  Award,
  Activity,
  TrendingUp,
  Settings,
  Download,
  Upload,
  X,
  Check,
  FileText,
  AlertCircle,
  Info,
  User,
  ThumbsUp,
  ThumbsDown,
  MessageCircle,
  ExternalLink
} from 'lucide-react';

const InstitutionManagement = () => {
  const [activeTab, setActiveTab] = useState('institutions'); // 'institutions' or 'requests'
  const [selectedType, setSelectedType] = useState('all');
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedInstitution, setSelectedInstitution] = useState(null);
  const [selectedRequest, setSelectedRequest] = useState(null);
  const [showCreateModal, setShowCreateModal] = useState(false);
  const [showApprovalModal, setShowApprovalModal] = useState(false);
  const [approvalAction, setApprovalAction] = useState(null);

  const institutionTypes = [
    { id: 'all', label: 'All Institutions', count: 89 },
    { id: 'high-school', label: 'High Schools', count: 34 },
    { id: 'university', label: 'Universities', count: 18 },
    { id: 'college', label: 'Colleges', count: 25 },
    { id: 'middle-school', label: 'Middle Schools', count: 12 }
  ];

  // Mock pending requests data
  const pendingRequests = [
    {
      id: 'req-001',
      institutionName: 'Global Environmental Academy',
      institutionType: 'university',
      location: 'San Francisco, CA',
      address: '789 Innovation Way, San Francisco, CA 94105',
      website: 'www.globalenvacademy.edu',
      establishedYear: 2010,
      principalName: 'Dr. Maria Rodriguez',
      principalEmail: 'maria.rodriguez@globalenvacademy.edu',
      principalPhone: '+1-555-0890',
      contactPersonName: 'James Chen',
      contactPersonEmail: 'james.chen@globalenvacademy.edu',
      contactPersonPhone: '+1-555-0891',
      contactPersonRole: 'IT Director',
      studentCount: 2500,
      teacherCount: 180,
      specializations: ['Climate Science', 'Renewable Energy', 'Environmental Policy'],
      description: 'A leading institution in environmental research and sustainable technology education.',
      accreditations: 'WASC Accredited, Green University Certification',
      previousPlatforms: 'Canvas LMS, Google Classroom',
      expectations: 'We aim to integrate environmental education across all our programs and engage students with interactive learning experiences.',
      submittedDate: '2025-01-15T10:30:00',
      documents: [
        { id: 1, name: 'Accreditation Certificate.pdf', size: 2500000, type: 'application/pdf' },
        { id: 2, name: 'Institution Profile.pdf', size: 1800000, type: 'application/pdf' },
        { id: 3, name: 'Authorization Letter.pdf', size: 950000, type: 'application/pdf' },
        { id: 4, name: 'Educational License.pdf', size: 1200000, type: 'application/pdf' }
      ],
      priority: 'high',
      notes: []
    },
    {
      id: 'req-002',
      institutionName: 'Green Valley Elementary',
      institutionType: 'elementary-school',
      location: 'Portland, OR',
      address: '456 Oak Street, Portland, OR 97201',
      website: 'www.greenvalleyelem.org',
      establishedYear: 1995,
      principalName: 'Sarah Johnson',
      principalEmail: 'sarah.johnson@greenvalleyelem.org',
      principalPhone: '+1-555-0992',
      contactPersonName: 'Mike Wilson',
      contactPersonEmail: 'mike.wilson@greenvalleyelem.org',
      contactPersonPhone: '+1-555-0993',
      contactPersonRole: 'Technology Coordinator',
      studentCount: 350,
      teacherCount: 25,
      specializations: ['Outdoor Education', 'Environmental Awareness', 'Nature Studies'],
      description: 'Elementary school focused on environmental education and outdoor learning experiences.',
      accreditations: 'State Education Department Approved',
      previousPlatforms: 'Seesaw, Google for Education',
      expectations: 'Enhance our environmental curriculum with interactive content suitable for K-5 students.',
      submittedDate: '2025-01-18T14:15:00',
      documents: [
        { id: 1, name: 'School Registration.pdf', size: 1500000, type: 'application/pdf' },
        { id: 2, name: 'Principal Authorization.pdf', size: 800000, type: 'application/pdf' },
        { id: 3, name: 'Educational Program Overview.pdf', size: 2200000, type: 'application/pdf' }
      ],
      priority: 'medium',
      notes: [
        { id: 1, author: 'Admin Team', message: 'Need to verify elementary curriculum compatibility', timestamp: '2025-01-19T09:00:00' }
      ]
    },
    {
      id: 'req-003',
      institutionName: 'Sustainable Business College',
      institutionType: 'college',
      location: 'Austin, TX',
      address: '123 Business Blvd, Austin, TX 78701',
      website: 'www.sustainbiz.edu',
      establishedYear: 2008,
      principalName: 'Prof. Robert Davis',
      principalEmail: 'robert.davis@sustainbiz.edu',
      principalPhone: '+1-555-0794',
      contactPersonName: 'Lisa Park',
      contactPersonEmail: 'lisa.park@sustainbiz.edu',
      contactPersonPhone: '+1-555-0795',
      contactPersonRole: 'Academic Technology Lead',
      studentCount: 1200,
      teacherCount: 85,
      specializations: ['Sustainable Business', 'Environmental Economics', 'Green Technology'],
      description: 'Business college specializing in sustainable practices and environmental entrepreneurship.',
      accreditations: 'AACSB Accredited, B Corp Education Partner',
      previousPlatforms: 'Blackboard, Moodle',
      expectations: 'Integrate environmental sustainability into business education programs.',
      submittedDate: '2025-01-20T11:45:00',
      documents: [
        { id: 1, name: 'AACSB Accreditation.pdf', size: 3200000, type: 'application/pdf' },
        { id: 2, name: 'B Corp Certificate.pdf', size: 1100000, type: 'application/pdf' },
        { id: 3, name: 'Program Catalog.pdf', size: 4500000, type: 'application/pdf' }
      ],
      priority: 'high',
      notes: []
    }
  ];

  // Mock institution data
  const institutions = [
    {
      id: 1,
      name: "Green Valley High School",
      type: "high-school",
      location: "California, USA",
      address: "123 Education St, Green Valley, CA 90210",
      phone: "+1-555-0123",
      email: "admin@greenvalleys.edu",
      website: "www.greenvalleys.edu",
      principal: "Dr. Jennifer Martinez",
      establishedYear: 1995,
      studentCount: 1247,
      teacherCount: 78,
      activeUsers: 156,
      status: "active",
      subscription: "premium",
      lastActivity: "2025-09-21T15:30:00",
      joinDate: "2024-01-15",
      specializations: ["Environmental Science", "STEM", "Sustainability"],
      engagementRate: 94.2,
      completionRate: 89.7,
      avgSessionTime: "28 minutes",
      monthlyGrowth: 12.5,
      certifications: ["Green Schools Alliance", "LEED Certified"],
      contact: {
        primaryContact: "Sarah Mitchell",
        role: "IT Coordinator",
        phone: "+1-555-0124",
        email: "sarah.mitchell@greenvalleys.edu"
      }
    },
    {
      id: 2,
      name: "EcoTech Institute",
      type: "university",
      location: "Seattle, WA",
      address: "456 Innovation Ave, Seattle, WA 98101",
      phone: "+1-555-0234",
      email: "info@ecotech.edu",
      website: "www.ecotech.edu",
      principal: "Prof. Michael Chen",
      establishedYear: 2003,
      studentCount: 3456,
      teacherCount: 234,
      activeUsers: 312,
      status: "active",
      subscription: "enterprise",
      lastActivity: "2025-09-21T14:45:00",
      joinDate: "2023-09-01",
      specializations: ["Climate Science", "Renewable Energy", "Environmental Technology"],
      engagementRate: 91.8,
      completionRate: 94.1,
      avgSessionTime: "35 minutes",
      monthlyGrowth: 8.7,
      certifications: ["AACSB Accredited", "Carbon Neutral Campus"],
      contact: {
        primaryContact: "Dr. Lisa Wang",
        role: "Academic Technology Director",
        phone: "+1-555-0235",
        email: "lisa.wang@ecotech.edu"
      }
    },
    {
      id: 3,
      name: "Nature Academy",
      type: "middle-school",
      location: "Denver, CO",
      address: "789 Nature Way, Denver, CO 80202",
      phone: "+1-555-0345",
      email: "contact@natureacademy.org",
      website: "www.natureacademy.org",
      principal: "Ms. Amanda Rodriguez",
      establishedYear: 2010,
      studentCount: 567,
      teacherCount: 45,
      activeUsers: 89,
      status: "active",
      subscription: "standard",
      lastActivity: "2025-09-21T13:20:00",
      joinDate: "2024-03-12",
      specializations: ["Outdoor Education", "Environmental Awareness", "Nature Studies"],
      engagementRate: 88.4,
      completionRate: 85.3,
      avgSessionTime: "22 minutes",
      monthlyGrowth: 15.2,
      certifications: ["Outdoor Education Association"],
      contact: {
        primaryContact: "Tom Wilson",
        role: "Technology Coordinator",
        phone: "+1-555-0346",
        email: "tom.wilson@natureacademy.org"
      }
    },
    {
      id: 4,
      name: "Sustainability College",
      type: "college",
      location: "Portland, OR",
      address: "321 Sustainable Blvd, Portland, OR 97205",
      phone: "+1-555-0456",
      email: "admissions@sustaincollege.edu",
      website: "www.sustaincollege.edu",
      principal: "Dr. Robert Green",
      establishedYear: 1987,
      studentCount: 2134,
      teacherCount: 156,
      activeUsers: 278,
      status: "active",
      subscription: "premium",
      lastActivity: "2025-09-21T16:10:00",
      joinDate: "2023-11-20",
      specializations: ["Sustainable Business", "Environmental Policy", "Green Technology"],
      engagementRate: 92.6,
      completionRate: 91.4,
      avgSessionTime: "31 minutes",
      monthlyGrowth: 6.8,
      certifications: ["B Corp Certified", "ISO 14001"],
      contact: {
        primaryContact: "Maria Santos",
        role: "Digital Learning Manager",
        phone: "+1-555-0457",
        email: "maria.santos@sustaincollege.edu"
      }
    },
    {
      id: 5,
      name: "Climate Science University",
      type: "university",
      location: "Boulder, CO",
      address: "147 Research Dr, Boulder, CO 80309",
      phone: "+1-555-0567",
      email: "info@climatesci.edu",
      website: "www.climatesci.edu",
      principal: "Dr. Elizabeth Thompson",
      establishedYear: 1999,
      studentCount: 4567,
      teacherCount: 289,
      activeUsers: 423,
      status: "pending",
      subscription: "trial",
      lastActivity: "2025-09-20T09:30:00",
      joinDate: "2025-09-15",
      specializations: ["Climate Research", "Atmospheric Science", "Data Analytics"],
      engagementRate: 79.3,
      completionRate: 82.6,
      avgSessionTime: "27 minutes",
      monthlyGrowth: 0,
      certifications: ["Research I Institution", "Climate Action Plan"],
      contact: {
        primaryContact: "Dr. James Park",
        role: "Educational Technology Lead",
        phone: "+1-555-0568",
        email: "james.park@climatesci.edu"
      }
    },
    {
      id: 6,
      name: "Earth Studies Institute",
      type: "college",
      location: "Austin, TX",
      address: "258 Earth Ln, Austin, TX 78701",
      phone: "+1-555-0678",
      email: "hello@earthstudies.edu",
      website: "www.earthstudies.edu",
      principal: "Prof. Sarah Anderson",
      establishedYear: 2015,
      studentCount: 892,
      teacherCount: 67,
      activeUsers: 134,
      status: "suspended",
      subscription: "standard",
      lastActivity: "2025-09-18T11:45:00",
      joinDate: "2024-05-08",
      specializations: ["Geology", "Earth Sciences", "Environmental Studies"],
      engagementRate: 72.1,
      completionRate: 76.8,
      avgSessionTime: "19 minutes",
      monthlyGrowth: -2.3,
      certifications: ["Regional Accreditation"],
      contact: {
        primaryContact: "Kevin Brown",
        role: "IT Administrator",
        phone: "+1-555-0679",
        email: "kevin.brown@earthstudies.edu"
      }
    }
  ];

  const overviewStats = [
    {
      title: 'Total Institutions',
      value: '89',
      change: '+5',
      icon: School,
      color: '#3b82f6',
      description: 'Registered educational institutions'
    },
    {
      title: 'Pending Requests',
      value: '3',
      change: '+2',
      icon: Clock,
      color: '#f59e0b',
      description: 'Awaiting admin review'
    },
    {
      title: 'Active Users',
      value: '12,847',
      change: '+234',
      icon: Users,
      color: '#10b981',
      description: 'Combined active users'
    },
    {
      title: 'Avg Engagement',
      value: '87.3%',
      change: '+3.1%',
      icon: Activity,
      color: '#8b5cf6',
      description: 'Platform engagement rate'
    }
  ];

  const filteredInstitutions = institutions.filter(institution => {
    const matchesType = selectedType === 'all' || institution.type === selectedType;
    const matchesSearch = institution.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                         institution.location.toLowerCase().includes(searchTerm.toLowerCase()) ||
                         institution.principal.toLowerCase().includes(searchTerm.toLowerCase());
    return matchesType && matchesSearch;
  });

  const getStatusColor = (status) => {
    switch(status) {
      case 'active': return { bg: '#dcfce7', text: '#166534', icon: CheckCircle };
      case 'pending': return { bg: '#fef3c7', text: '#92400e', icon: Clock };
      case 'suspended': return { bg: '#fee2e2', text: '#991b1b', icon: AlertTriangle };
      default: return { bg: '#f3f4f6', text: '#374151', icon: CheckCircle };
    }
  };

  const getSubscriptionColor = (subscription) => {
    switch(subscription) {
      case 'enterprise': return { bg: '#f3e8ff', text: '#7c3aed' };
      case 'premium': return { bg: '#dbeafe', text: '#1e40af' };
      case 'standard': return { bg: '#dcfce7', text: '#166534' };
      case 'trial': return { bg: '#fef3c7', text: '#92400e' };
      default: return { bg: '#f3f4f6', text: '#374151' };
    }
  };

  const getTypeIcon = (type) => {
    switch(type) {
      case 'university': return <GraduationCap size={16} style={{ color: '#7c3aed' }} />;
      case 'college': return <Building size={16} style={{ color: '#3b82f6' }} />;
      case 'high-school': return <School size={16} style={{ color: '#059669' }} />;
      case 'middle-school': return <School size={16} style={{ color: '#f59e0b' }} />;
      default: return <School size={16} style={{ color: '#6b7280' }} />;
    }
  };

  const formatDate = (dateString) => {
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', { 
      year: 'numeric', 
      month: 'short', 
      day: 'numeric' 
    });
  };

  const formatLastActivity = (dateString) => {
    const date = new Date(dateString);
    const now = new Date();
    const diffInHours = Math.floor((now - date) / (1000 * 60 * 60));
    
    if (diffInHours < 1) return 'Active now';
    if (diffInHours < 24) return `${diffInHours}h ago`;
    const diffInDays = Math.floor(diffInHours / 24);
    return `${diffInDays}d ago`;
  };

  const formatFileSize = (bytes) => {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
  };

  const getPriorityColor = (priority) => {
    switch(priority) {
      case 'high': return { bg: '#fee2e2', text: '#991b1b', border: '#fecaca' };
      case 'medium': return { bg: '#fef3c7', text: '#92400e', border: '#fde68a' };
      case 'low': return { bg: '#dcfce7', text: '#166534', border: '#bbf7d0' };
      default: return { bg: '#f3f4f6', text: '#374151', border: '#e5e7eb' };
    }
  };

  const handleApproveRequest = (request) => {
    setSelectedRequest(request);
    setApprovalAction('approve');
    setShowApprovalModal(true);
  };

  const handleRejectRequest = (request) => {
    setSelectedRequest(request);
    setApprovalAction('reject');
    setShowApprovalModal(true);
  };

  const confirmApproval = () => {
    if (approvalAction === 'approve') {
      console.log('Approving request:', selectedRequest.id);
      // Here you would typically make an API call to approve the request
      // After approval, the institution would be moved to the institutions list
    } else if (approvalAction === 'reject') {
      console.log('Rejecting request:', selectedRequest.id);
      // Here you would typically make an API call to reject the request
      // The request would be removed or marked as rejected
    }
    setShowApprovalModal(false);
    setSelectedRequest(null);
    setApprovalAction(null);
  };

  return (
    <div style={{ minHeight: '100vh', background: 'linear-gradient(to bottom right, #f0f9ff, #f0fdf4)', padding: '1rem' }}>
      <div style={{ maxWidth: '1600px', margin: '0 auto' }}>
        {/* Header */}
        <div style={{ marginBottom: '2rem' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
            <div>
              <h1 style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '0.5rem' }}>
                Institution Management
              </h1>
              <p style={{ color: '#6b7280' }}>
                Manage educational institutions and review join requests
              </p>
            </div>
            <div style={{ display: 'flex', gap: '0.5rem' }}>
              <button
                style={{
                  padding: '0.5rem 1rem',
                  backgroundColor: '#f3f4f6',
                  color: '#374151',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <Download size={16} />
                Export List
              </button>
              <button
                style={{
                  padding: '0.5rem 1rem',
                  backgroundColor: '#f3f4f6',
                  color: '#374151',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <Upload size={16} />
                Bulk Import
              </button>
              <button
                onClick={() => setShowCreateModal(true)}
                style={{
                  padding: '0.5rem 1rem',
                  backgroundColor: '#059669',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <Plus size={16} />
                Add Institution
              </button>
            </div>
          </div>

          {/* Overview Stats */}
          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', 
            gap: '1rem',
            marginBottom: '2rem'
          }}>
            {overviewStats.map((stat, index) => {
              const Icon = stat.icon;
              return (
                <div 
                  key={index}
                  style={{ 
                    backgroundColor: 'white', 
                    padding: '1.5rem', 
                    borderRadius: '0.75rem',
                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                    border: '1px solid #f3f4f6'
                  }}
                >
                  <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '1rem' }}>
                    <div style={{
                      width: '3rem',
                      height: '3rem',
                      backgroundColor: `${stat.color}20`,
                      borderRadius: '0.75rem',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center'
                    }}>
                      <Icon size={24} style={{ color: stat.color }} />
                    </div>
                    <span style={{ 
                      fontSize: '0.875rem', 
                      fontWeight: '500',
                      color: '#10b981',
                      backgroundColor: '#dcfce7',
                      padding: '0.25rem 0.5rem',
                      borderRadius: '0.25rem'
                    }}>
                      {stat.change}
                    </span>
                  </div>
                  <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '0.5rem' }}>
                    {stat.value}
                  </div>
                  <div style={{ fontSize: '1rem', fontWeight: '500', color: '#1f2937', marginBottom: '0.25rem' }}>
                    {stat.title}
                  </div>
                  <div style={{ fontSize: '0.875rem', color: '#6b7280' }}>
                    {stat.description}
                  </div>
                </div>
              );
            })}
          </div>

          {/* Tab Navigation */}
          <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '2rem' }}>
            <button
              onClick={() => setActiveTab('institutions')}
              style={{
                padding: '0.75rem 1.5rem',
                border: 'none',
                borderRadius: '0.5rem',
                cursor: 'pointer',
                display: 'flex',
                alignItems: 'center',
                gap: '0.5rem',
                backgroundColor: activeTab === 'institutions' ? '#059669' : '#f3f4f6',
                color: activeTab === 'institutions' ? 'white' : '#374151',
                fontWeight: activeTab === 'institutions' ? '500' : 'normal'
              }}
            >
              <School size={16} />
              Institutions ({institutions.length})
            </button>
            <button
              onClick={() => setActiveTab('requests')}
              style={{
                padding: '0.75rem 1.5rem',
                border: 'none',
                borderRadius: '0.5rem',
                cursor: 'pointer',
                display: 'flex',
                alignItems: 'center',
                gap: '0.5rem',
                backgroundColor: activeTab === 'requests' ? '#059669' : '#f3f4f6',
                color: activeTab === 'requests' ? 'white' : '#374151',
                fontWeight: activeTab === 'requests' ? '500' : 'normal'
              }}
            >
              <Clock size={16} />
              Pending Requests ({pendingRequests.length})
              {pendingRequests.length > 0 && (
                <span style={{
                  padding: '0.125rem 0.375rem',
                  borderRadius: '0.75rem',
                  fontSize: '0.75rem',
                  backgroundColor: '#dc2626',
                  color: 'white'
                }}>
                  !
                </span>
              )}
            </button>
          </div>

          {activeTab === 'institutions' ? (
            <>
              {/* Type Filter Tabs */}
              <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem', flexWrap: 'wrap' }}>
                {institutionTypes.map(type => (
                  <button
                    key={type.id}
                    onClick={() => setSelectedType(type.id)}
                    style={{
                      padding: '0.75rem 1rem',
                      border: 'none',
                      borderRadius: '0.5rem',
                      cursor: 'pointer',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '0.5rem',
                      backgroundColor: selectedType === type.id ? '#059669' : '#f3f4f6',
                      color: selectedType === type.id ? 'white' : '#374151',
                      fontWeight: selectedType === type.id ? '500' : 'normal'
                    }}
                  >
                    {type.label}
                    <span style={{
                      padding: '0.125rem 0.375rem',
                      borderRadius: '0.75rem',
                      fontSize: '0.75rem',
                      backgroundColor: selectedType === type.id ? 'rgba(255,255,255,0.2)' : '#e5e7eb',
                      color: selectedType === type.id ? 'white' : '#6b7280'
                    }}>
                      {type.count}
                    </span>
                  </button>
                ))}
              </div>

              {/* Search and Filter */}
              <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>
                <div style={{ position: 'relative', flex: 1 }}>
                  <Search 
                    size={20} 
                    style={{ 
                      position: 'absolute', 
                      left: '0.75rem', 
                      top: '50%', 
                      transform: 'translateY(-50%)', 
                      color: '#6b7280' 
                    }} 
                  />
                  <input
                    type="text"
                    placeholder="Search institutions..."
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                    style={{
                      width: '100%',
                      padding: '0.75rem 0.75rem 0.75rem 2.5rem',
                      border: '1px solid #d1d5db',
                      borderRadius: '0.5rem',
                      fontSize: '1rem'
                    }}
                  />
                </div>
                <button
                  style={{
                    padding: '0.75rem',
                    border: '1px solid #d1d5db',
                    borderRadius: '0.5rem',
                    backgroundColor: 'white',
                    cursor: 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem'
                  }}
                >
                  <Filter size={20} />
                  Filters
                </button>
              </div>
            </>
          ) : (
            <div style={{ marginBottom: '1rem' }}>
              <div style={{ 
                backgroundColor: '#fef3c7', 
                padding: '1rem', 
                borderRadius: '0.5rem',
                marginBottom: '1rem',
                border: '1px solid #f59e0b'
              }}>
                <div style={{ display: 'flex', alignItems: 'flex-start', gap: '0.5rem' }}>
                  <AlertCircle size={20} style={{ color: '#92400e', marginTop: '0.125rem', flexShrink: 0 }} />
                  <div>
                    <h4 style={{ fontSize: '0.875rem', fontWeight: '500', color: '#92400e', marginBottom: '0.5rem' }}>
                      Review Required
                    </h4>
                    <p style={{ fontSize: '0.875rem', color: '#92400e' }}>
                      {pendingRequests.length} institution{pendingRequests.length !== 1 ? 's' : ''} waiting for approval. Please review documentation and make approval decisions.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          )}
        </div>

        {/* Content Area */}
        {activeTab === 'institutions' ? (
          /* Institutions List */
          <div style={{ backgroundColor: 'white', borderRadius: '0.75rem', boxShadow: '0 1px 3px rgba(0,0,0,0.1)', overflow: 'hidden' }}>
            <div style={{ overflowX: 'auto' }}>
              <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                <thead>
                  <tr style={{ backgroundColor: '#f9fafb', borderBottom: '1px solid #e5e7eb' }}>
                    <th style={{ padding: '1rem', textAlign: 'left', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Institution
                    </th>
                    <th style={{ padding: '1rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Type & Location
                    </th>
                    <th style={{ padding: '1rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Users
                    </th>
                    <th style={{ padding: '1rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Status
                    </th>
                    <th style={{ padding: '1rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Subscription
                    </th>
                    <th style={{ padding: '1rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Engagement
                    </th>
                    <th style={{ padding: '1rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Last Activity
                    </th>
                    <th style={{ padding: '1rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: '500', color: '#6b7280' }}>
                      Actions
                    </th>
                  </tr>
                </thead>
                <tbody>
                  {filteredInstitutions.map((institution) => {
                    const statusColor = getStatusColor(institution.status);
                    const subscriptionColor = getSubscriptionColor(institution.subscription);
                    const StatusIcon = statusColor.icon;
                    
                    return (
                      <tr key={institution.id} style={{ borderBottom: '1px solid #f3f4f6' }}>
                        <td style={{ padding: '1rem' }}>
                          <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                            <div style={{
                              width: '3rem',
                              height: '3rem',
                              backgroundColor: '#3b82f6',
                              borderRadius: '0.75rem',
                              display: 'flex',
                              alignItems: 'center',
                              justifyContent: 'center',
                              color: 'white',
                              fontWeight: 'bold',
                              fontSize: '0.875rem'
                            }}>
                              {institution.name.split(' ').map(word => word[0]).join('').substring(0, 2)}
                            </div>
                            <div>
                              <div style={{ fontSize: '0.875rem', fontWeight: '500', color: '#1f2937' }}>
                                {institution.name}
                              </div>
                              <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>
                                {institution.principal}
                              </div>
                            </div>
                          </div>
                        </td>
                        
                        <td style={{ padding: '1rem', textAlign: 'center' }}>
                          <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '0.25rem' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                              {getTypeIcon(institution.type)}
                              <span style={{ fontSize: '0.875rem', fontWeight: '500', color: '#1f2937', textTransform: 'capitalize' }}>
                                {institution.type.replace('-', ' ')}
                              </span>
                            </div>
                            <div style={{ fontSize: '0.75rem', color: '#6b7280', display: 'flex', alignItems: 'center', gap: '0.25rem' }}>
                              <MapPin size={12} />
                              {institution.location}
                            </div>
                          </div>
                        </td>
                        
                        <td style={{ padding: '1rem', textAlign: 'center' }}>
                          <div style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                            <div style={{ fontWeight: '500' }}>{institution.activeUsers} active</div>
                            <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>
                              {institution.studentCount} students
                            </div>
                          </div>
                        </td>
                        
                        <td style={{ padding: '1rem', textAlign: 'center' }}>
                          <span style={{
                            display: 'inline-flex',
                            alignItems: 'center',
                            gap: '0.25rem',
                            padding: '0.25rem 0.5rem',
                            borderRadius: '0.375rem',
                            fontSize: '0.75rem',
                            fontWeight: '500',
                            backgroundColor: statusColor.bg,
                            color: statusColor.text
                          }}>
                            <StatusIcon size={12} />
                            {institution.status.charAt(0).toUpperCase() + institution.status.slice(1)}
                          </span>
                        </td>
                        
                        <td style={{ padding: '1rem', textAlign: 'center' }}>
                          <span style={{
                            padding: '0.25rem 0.5rem',
                            borderRadius: '0.375rem',
                            fontSize: '0.75rem',
                            fontWeight: '500',
                            backgroundColor: subscriptionColor.bg,
                            color: subscriptionColor.text,
                            textTransform: 'capitalize'
                          }}>
                            {institution.subscription}
                          </span>
                        </td>
                        
                        <td style={{ padding: '1rem', textAlign: 'center' }}>
                          <div style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                            <div style={{ fontWeight: '500' }}>{institution.engagementRate}%</div>
                            <div style={{ fontSize: '0.75rem', color: institution.monthlyGrowth > 0 ? '#10b981' : '#ef4444' }}>
                              {institution.monthlyGrowth > 0 ? '+' : ''}{institution.monthlyGrowth}%
                            </div>
                          </div>
                        </td>
                        
                        <td style={{ padding: '1rem', textAlign: 'center' }}>
                          <span style={{ fontSize: '0.875rem', color: '#6b7280' }}>
                            {formatLastActivity(institution.lastActivity)}
                          </span>
                        </td>
                        
                        <td style={{ padding: '1rem', textAlign: 'center' }}>
                          <div style={{ display: 'flex', gap: '0.25rem', justifyContent: 'center' }}>
                            <button
                              onClick={() => setSelectedInstitution(institution)}
                              style={{
                                padding: '0.25rem',
                                backgroundColor: '#f3f4f6',
                                color: '#374151',
                                border: 'none',
                                borderRadius: '0.25rem',
                                cursor: 'pointer'
                              }}
                              title="View Details"
                            >
                              <Eye size={14} />
                            </button>
                            <button
                              style={{
                                padding: '0.25rem',
                                backgroundColor: '#f3f4f6',
                                color: '#374151',
                                border: 'none',
                                borderRadius: '0.25rem',
                                cursor: 'pointer'
                              }}
                              title="Edit Institution"
                            >
                              <Edit size={14} />
                            </button>
                            <button
                              style={{
                                padding: '0.25rem',
                                backgroundColor: '#f3f4f6',
                                color: '#374151',
                                border: 'none',
                                borderRadius: '0.25rem',
                                cursor: 'pointer'
                              }}
                              title="More Options"
                            >
                              <MoreVertical size={14} />
                            </button>
                          </div>
                        </td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
          </div>
        ) : (
          /* Pending Requests List */
          <div style={{ space: '1rem' }}>
            {pendingRequests.map((request) => {
              const priorityColor = getPriorityColor(request.priority);
              
              return (
                <div 
                  key={request.id}
                  style={{ 
                    backgroundColor: 'white', 
                    borderRadius: '0.75rem', 
                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                    border: '1px solid #f3f4f6',
                    padding: '1.5rem',
                    marginBottom: '1rem'
                  }}
                >
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>
                    <div style={{ flex: 1 }}>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.5rem' }}>
                        <div style={{
                          width: '3rem',
                          height: '3rem',
                          backgroundColor: '#f59e0b',
                          borderRadius: '0.75rem',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          color: 'white',
                          fontWeight: 'bold',
                          fontSize: '0.875rem'
                        }}>
                          {request.institutionName.split(' ').map(word => word[0]).join('').substring(0, 2)}
                        </div>
                        <div>
                          <h3 style={{ fontSize: '1.125rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '0.25rem' }}>
                            {request.institutionName}
                          </h3>
                          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', fontSize: '0.875rem', color: '#6b7280' }}>
                            <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>
                              {getTypeIcon(request.institutionType)}
                              {request.institutionType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                            </span>
                            <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>
                              <MapPin size={12} />
                              {request.location}
                            </span>
                            <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>
                              <User size={12} />
                              {request.principalName}
                            </span>
                            <span style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>
                              <Calendar size={12} />
                              Submitted {formatDate(request.submittedDate)}
                            </span>
                          </div>
                        </div>
                      </div>
                      
                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '1rem' }}>
                        <span style={{
                          padding: '0.25rem 0.5rem',
                          borderRadius: '0.375rem',
                          fontSize: '0.75rem',
                          fontWeight: '500',
                          backgroundColor: priorityColor.bg,
                          color: priorityColor.text,
                          border: `1px solid ${priorityColor.border}`,
                          textTransform: 'capitalize'
                        }}>
                          {request.priority} Priority
                        </span>
                        <span style={{
                          padding: '0.25rem 0.5rem',
                          borderRadius: '0.375rem',
                          fontSize: '0.75rem',
                          fontWeight: '500',
                          backgroundColor: '#e0f2fe',
                          color: '#0277bd',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '0.25rem'
                        }}>
                          <Users size={10} />
                          {request.studentCount} students, {request.teacherCount} teachers
                        </span>
                        <span style={{
                          padding: '0.25rem 0.5rem',
                          borderRadius: '0.375rem',
                          fontSize: '0.75rem',
                          fontWeight: '500',
                          backgroundColor: '#f3e8ff',
                          color: '#7c3aed',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '0.25rem'
                        }}>
                          <FileText size={10} />
                          {request.documents.length} documents
                        </span>
                      </div>
                      
                      <p style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '1rem', lineHeight: '1.5' }}>
                        {request.description}
                      </p>
                      
                      <div style={{ marginBottom: '1rem' }}>
                        <div style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem' }}>
                          <strong>Specializations:</strong>
                        </div>
                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                          {request.specializations.map((spec, index) => (
                            <span
                              key={index}
                              style={{
                                padding: '0.25rem 0.5rem',
                                backgroundColor: '#dbeafe',
                                color: '#1e40af',
                                borderRadius: '0.25rem',
                                fontSize: '0.75rem'
                              }}
                            >
                              {spec}
                            </span>
                          ))}
                        </div>
                      </div>
                      
                      {request.notes.length > 0 && (
                        <div style={{ marginBottom: '1rem' }}>
                          <div style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem' }}>
                            <strong>Admin Notes:</strong>
                          </div>
                          {request.notes.map((note) => (
                            <div key={note.id} style={{
                              padding: '0.75rem',
                              backgroundColor: '#fef7cd',
                              borderRadius: '0.5rem',
                              fontSize: '0.875rem',
                              color: '#92400e',
                              marginBottom: '0.5rem'
                            }}>
                              <div style={{ fontWeight: '500', marginBottom: '0.25rem' }}>
                                {note.author} - {formatDate(note.timestamp)}
                              </div>
                              {note.message}
                            </div>
                          ))}
                        </div>
                      )}
                    </div>
                    
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', marginLeft: '1rem' }}>
                      <button
                        onClick={() => setSelectedRequest(request)}
                        style={{
                          padding: '0.5rem 1rem',
                          backgroundColor: '#f3f4f6',
                          color: '#374151',
                          border: 'none',
                          borderRadius: '0.375rem',
                          cursor: 'pointer',
                          fontSize: '0.875rem',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '0.5rem'
                        }}
                      >
                        <Eye size={14} />
                        Review
                      </button>
                      <button
                        onClick={() => handleApproveRequest(request)}
                        style={{
                          padding: '0.5rem 1rem',
                          backgroundColor: '#059669',
                          color: 'white',
                          border: 'none',
                          borderRadius: '0.375rem',
                          cursor: 'pointer',
                          fontSize: '0.875rem',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '0.5rem'
                        }}
                      >
                        <ThumbsUp size={14} />
                        Approve
                      </button>
                      <button
                        onClick={() => handleRejectRequest(request)}
                        style={{
                          padding: '0.5rem 1rem',
                          backgroundColor: '#dc2626',
                          color: 'white',
                          border: 'none',
                          borderRadius: '0.375rem',
                          cursor: 'pointer',
                          fontSize: '0.875rem',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '0.5rem'
                        }}
                      >
                        <ThumbsDown size={14} />
                        Reject
                      </button>
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
        )}

        {/* Pagination */}
        <div style={{ display: 'flex', justifyContent: 'center', marginTop: '2rem' }}>
          <div style={{ display: 'flex', gap: '0.5rem' }}>
            <button style={{ padding: '0.5rem 1rem', backgroundColor: '#f3f4f6', border: 'none', borderRadius: '0.375rem', cursor: 'pointer' }}>
              Previous
            </button>
            <button style={{ padding: '0.5rem 1rem', backgroundColor: '#059669', color: 'white', border: 'none', borderRadius: '0.375rem', cursor: 'pointer' }}>
              1
            </button>
            <button style={{ padding: '0.5rem 1rem', backgroundColor: '#f3f4f6', border: 'none', borderRadius: '0.375rem', cursor: 'pointer' }}>
              2
            </button>
            <button style={{ padding: '0.5rem 1rem', backgroundColor: '#f3f4f6', border: 'none', borderRadius: '0.375rem', cursor: 'pointer' }}>
              Next
            </button>
          </div>
        </div>
      </div>

      {/* Institution Detail Modal */}
      {selectedInstitution && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000
        }}>
          <div style={{
            backgroundColor: 'white',
            padding: '2rem',
            borderRadius: '0.75rem',
            maxWidth: '800px',
            width: '90%',
            maxHeight: '90vh',
            overflow: 'auto'
          }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>
              <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>
                {selectedInstitution.name}
              </h2>
              <button
                onClick={() => setSelectedInstitution(null)}
                style={{
                  padding: '0.5rem',
                  border: 'none',
                  background: 'none',
                  cursor: 'pointer',
                  fontSize: '1.5rem'
                }}
              >
                
              </button>
            </div>
            
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1.5rem' }}>
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Principal/President
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.principal}
                </p>
              </div>
              
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Established
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.establishedYear}
                </p>
              </div>
              
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Address
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.address}
                </p>
              </div>
              
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Contact
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.25rem' }}>
                  {selectedInstitution.phone}
                </p>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.email}
                </p>
              </div>
            </div>
            
            <div style={{ marginBottom: '1.5rem' }}>
              <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                Specializations
              </label>
              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                {selectedInstitution.specializations.map((spec, index) => (
                  <span
                    key={index}
                    style={{
                      padding: '0.25rem 0.5rem',
                      backgroundColor: '#dbeafe',
                      color: '#1e40af',
                      borderRadius: '0.25rem',
                      fontSize: '0.75rem'
                    }}
                  >
                    {spec}
                  </span>
                ))}
              </div>
            </div>
            
            <div style={{ marginBottom: '1.5rem' }}>
              <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                Platform Statistics
              </label>
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '1rem' }}>
                <div style={{ textAlign: 'center', padding: '1rem', backgroundColor: '#f9fafb', borderRadius: '0.5rem' }}>
                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937' }}>
                    {selectedInstitution.engagementRate}%
                  </div>
                  <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>Engagement Rate</div>
                </div>
                <div style={{ textAlign: 'center', padding: '1rem', backgroundColor: '#f9fafb', borderRadius: '0.5rem' }}>
                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937' }}>
                    {selectedInstitution.completionRate}%
                  </div>
                  <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>Completion Rate</div>
                </div>
                <div style={{ textAlign: 'center', padding: '1rem', backgroundColor: '#f9fafb', borderRadius: '0.5rem' }}>
                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937' }}>
                    {selectedInstitution.avgSessionTime}
                  </div>
                  <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>Avg Session Time</div>
                </div>
              </div>
            </div>
            
            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>
              <button
                onClick={() => setSelectedInstitution(null)}
                style={{
                  padding: '0.5rem 1rem',
                  border: '1px solid #d1d5db',
                  borderRadius: '0.375rem',
                  backgroundColor: 'white',
                  cursor: 'pointer'
                }}
              >
                Close
              </button>
              <button
                style={{
                  padding: '0.5rem 1rem',
                  backgroundColor: '#059669',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer'
                }}
              >
                Edit Institution
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Request Detail Modal */}
      {selectedRequest && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000
        }}>
          <div style={{
            backgroundColor: 'white',
            padding: '2rem',
            borderRadius: '0.75rem',
            maxWidth: '1000px',
            width: '95%',
            maxHeight: '95vh',
            overflow: 'auto'
          }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>
              <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>
                Review Institution Request
              </h2>
              <button
                onClick={() => setSelectedRequest(null)}
                style={{
                  padding: '0.5rem',
                  border: 'none',
                  background: 'none',
                  cursor: 'pointer',
                  fontSize: '1.5rem'
                }}
              >
                <X size={24} />
              </button>
            </div>
            
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '2rem' }}>
              {/* Left Column */}
              <div>
                <h3 style={{ fontSize: '1.125rem', fontWeight: 'bold', marginBottom: '1rem' }}>
                  Institution Information
                </h3>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Institution Name
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.75rem' }}>
                    {selectedRequest.institutionName}
                  </p>
                </div>
                
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1rem' }}>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Type
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.institutionType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                    </p>
                  </div>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Established
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.establishedYear}
                    </p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Address
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.75rem' }}>
                    {selectedRequest.address}
                  </p>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Website
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.75rem' }}>
                    <a href={`https://${selectedRequest.website}`} target="_blank" rel="noopener noreferrer" style={{ color: '#059669', textDecoration: 'underline', display: 'flex', alignItems: 'center', gap: '0.25rem' }}>
                      {selectedRequest.website}
                      <ExternalLink size={12} />
                    </a>
                  </p>
                </div>
                
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1rem' }}>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Students
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.studentCount.toLocaleString()}
                    </p>
                  </div>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Teachers
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.teacherCount.toLocaleString()}
                    </p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                    Specializations
                  </label>
                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                    {selectedRequest.specializations.map((spec, index) => (
                      <span
                        key={index}
                        style={{
                          padding: '0.25rem 0.5rem',
                          backgroundColor: '#dbeafe',
                          color: '#1e40af',
                          borderRadius: '0.25rem',
                          fontSize: '0.75rem'
                        }}
                      >
                        {spec}
                      </span>
                    ))}
                  </div>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Description
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5', marginBottom: '0.75rem' }}>
                    {selectedRequest.description}
                  </p>
                </div>
              </div>
              
              {/* Right Column */}
              <div>
                <h3 style={{ fontSize: '1.125rem', fontWeight: 'bold', marginBottom: '1rem' }}>
                  Contact Information
                </h3>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Principal/President
                  </h4>
                  <div style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    <p>{selectedRequest.principalName}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.principalEmail}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.principalPhone}</p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Primary Contact
                  </h4>
                  <div style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    <p>{selectedRequest.contactPersonName}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.contactPersonRole}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.contactPersonEmail}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.contactPersonPhone}</p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Accreditations
                  </h4>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    {selectedRequest.accreditations}
                  </p>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Previous Platforms
                  </h4>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    {selectedRequest.previousPlatforms}
                  </p>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Expectations
                  </h4>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    {selectedRequest.expectations}
                  </p>
                </div>
                
                <div>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Uploaded Documents ({selectedRequest.documents.length})
                  </h4>
                  <div style={{ space: '0.5rem' }}>
                    {selectedRequest.documents.map(doc => (
                      <div key={doc.id} style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'space-between',
                        padding: '0.75rem',
                        backgroundColor: '#f9fafb',
                        border: '1px solid #e5e7eb',
                        borderRadius: '0.5rem',
                        marginBottom: '0.5rem'
                      }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                          <FileText size={20} style={{ color: '#6b7280' }} />
                          <div>
                            <div style={{ fontSize: '0.875rem', color: '#1f2937', fontWeight: '500' }}>
                              {doc.name}
                            </div>
                            <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>
                              {formatFileSize(doc.size)}
                            </div>
                          </div>
                        </div>
                        <button
                          style={{
                            padding: '0.25rem 0.5rem',
                            backgroundColor: '#059669',
                            color: 'white',
                            border: 'none',
                            borderRadius: '0.25rem',
                            cursor: 'pointer',
                            fontSize: '0.75rem'
                          }}
                        >
                          View
                        </button>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
            
            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end', marginTop: '2rem', paddingTop: '1rem', borderTop: '1px solid #e5e7eb' }}>
              <button
                onClick={() => setSelectedRequest(null)}
                style={{
                  padding: '0.75rem 1.5rem',
                  border: '1px solid #d1d5db',
                  borderRadius: '0.375rem',
                  backgroundColor: 'white',
                  cursor: 'pointer',
                  color: '#374151'
                }}
              >
                Close
              </button>
              <button
                onClick={() => {
                  setSelectedRequest(null);
                  handleRejectRequest(selectedRequest);
                }}
                style={{
                  padding: '0.75rem 1.5rem',
                  backgroundColor: '#dc2626',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <ThumbsDown size={16} />
                Reject Request
              </button>
              <button
                onClick={() => {
                  setSelectedRequest(null);
                  handleApproveRequest(selectedRequest);
                }}
                style={{
                  padding: '0.75rem 1.5rem',
                  backgroundColor: '#059669',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <ThumbsUp size={16} />
                Approve Request
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Approval Confirmation Modal */}
      {showApprovalModal && selectedRequest && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1001
        }}>
          <div style={{
            backgroundColor: 'white',
            padding: '2rem',
            borderRadius: '0.75rem',
            maxWidth: '500px',
            width: '90%'
          }}>
            <div style={{ textAlign: 'center', marginBottom: '1.5rem' }}>
              <div style={{
                width: '4rem',
                height: '4rem',
                backgroundColor: approvalAction === 'approve' ? '#dcfce7' : '#fee2e2',
                borderRadius: '50%',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                margin: '0 auto 1rem'
              }}>
                {approvalAction === 'approve' ? (
                  <Check size={32} style={{ color: '#166534' }} />
                ) : (
                  <X size={32} style={{ color: '#991b1b' }} />
                )}
              </div>
              
              <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '0.5rem' }}>
                {approvalAction === 'approve' ? 'Approve Institution Request' : 'Reject Institution Request'}
              </h2>
              
              <p style={{ color: '#6b7280' }}>
                Are you sure you want to {approvalAction} the request from <strong>{selectedRequest.institutionName}</strong>?
              </p>
            </div>
            
            {approvalAction === 'approve' && (
              <div style={{ 
                backgroundColor: '#f0f9ff', 
                padding: '1rem', 
                borderRadius: '0.5rem',
                marginBottom: '1.5rem'
              }}>
                <h4 style={{ fontSize: '0.875rem', fontWeight: '500', color: '#1f2937', marginBottom: '0.5rem' }}>
                  What happens next:
                </h4>
                <ul style={{ fontSize: '0.875rem', color: '#6b7280', lineHeight: '1.5', paddingLeft: '1rem' }}>
                  <li>Institution will be added to the platform</li>
                  <li>Admin credentials will be sent to the primary contact</li>
                  <li>Access will be granted based on subscription tier</li>
                  <li>Onboarding materials will be provided</li>
                </ul>
              </div>
            )}
            
            {approvalAction === 'reject' && (
              <div style={{ marginBottom: '1.5rem' }}>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                  Rejection Reason (optional)
                </label>
                <textarea
                  placeholder="Provide a reason for rejection..."
                  rows={3}
                  style={{
                    width: '100%',
                    padding: '0.75rem',
                    border: '1px solid #d1d5db',
                    borderRadius: '0.5rem',
                    fontSize: '0.875rem',
                    fontFamily: 'inherit',
                    resize: 'vertical'
                  }}
                />
              </div>
            )}
            
            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>
              <button
                onClick={() => setShowApprovalModal(false)}
                style={{
                  padding: '0.75rem 1.5rem',
                  border: '1px solid #d1d5db',
                  borderRadius: '0.375rem',
                  backgroundColor: 'white',
                  cursor: 'pointer',
                  color: '#374151'
                }}
              >
                Cancel
              </button>
              <button
                onClick={confirmApproval}
                style={{
                  padding: '0.75rem 1.5rem',
                  backgroundColor: approvalAction === 'approve' ? '#059669' : '#dc2626',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                {approvalAction === 'approve' ? (
                  <>
                    <Check size={16} />
                    Confirm Approval
                  </>
                ) : (
                  <>
                    <X size={16} />
                    Confirm Rejection
                  </>
                )}
              </button>
            </div>
          </div>
        </div>
      )}
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000
        }}>
          <div style={{
            backgroundColor: 'white',
            padding: '2rem',
            borderRadius: '0.75rem',
            maxWidth: '800px',
            width: '90%',
            maxHeight: '90vh',
            overflow: 'auto'
          }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>
              <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>
                {selectedInstitution.name}
              </h2>
              <button
                onClick={() => setSelectedInstitution(null)}
                style={{
                  padding: '0.5rem',
                  border: 'none',
                  background: 'none',
                  cursor: 'pointer',
                  fontSize: '1.5rem'
                }}
              >
                
              </button>
            </div>
            
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1.5rem' }}>
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Principal/President
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.principal}
                </p>
              </div>
              
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Established
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.establishedYear}
                </p>
              </div>
              
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Address
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.address}
                </p>
              </div>
              
              <div>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                  Contact
                </label>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.25rem' }}>
                  {selectedInstitution.phone}
                </p>
                <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '1rem' }}>
                  {selectedInstitution.email}
                </p>
              </div>
            </div>
            
            <div style={{ marginBottom: '1.5rem' }}>
              <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                Specializations
              </label>
              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                {selectedInstitution.specializations.map((spec, index) => (
                  <span
                    key={index}
                    style={{
                      padding: '0.25rem 0.5rem',
                      backgroundColor: '#dbeafe',
                      color: '#1e40af',
                      borderRadius: '0.25rem',
                      fontSize: '0.75rem'
                    }}
                  >
                    {spec}
                  </span>
                ))}
              </div>
            </div>
            
            <div style={{ marginBottom: '1.5rem' }}>
              <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                Platform Statistics
              </label>
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '1rem' }}>
                <div style={{ textAlign: 'center', padding: '1rem', backgroundColor: '#f9fafb', borderRadius: '0.5rem' }}>
                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937' }}>
                    {selectedInstitution.engagementRate}%
                  </div>
                  <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>Engagement Rate</div>
                </div>
                <div style={{ textAlign: 'center', padding: '1rem', backgroundColor: '#f9fafb', borderRadius: '0.5rem' }}>
                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937' }}>
                    {selectedInstitution.completionRate}%
                  </div>
                  <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>Completion Rate</div>
                </div>
                <div style={{ textAlign: 'center', padding: '1rem', backgroundColor: '#f9fafb', borderRadius: '0.5rem' }}>
                  <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937' }}>
                    {selectedInstitution.avgSessionTime}
                  </div>
                  <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>Avg Session Time</div>
                </div>
              </div>
            </div>
            
            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>
              <button
                onClick={() => setSelectedInstitution(null)}
                style={{
                  padding: '0.5rem 1rem',
                  border: '1px solid #d1d5db',
                  borderRadius: '0.375rem',
                  backgroundColor: 'white',
                  cursor: 'pointer'
                }}
              >
                Close
              </button>
              <button
                style={{
                  padding: '0.5rem 1rem',
                  backgroundColor: '#059669',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer'
                }}
              >
                Edit Institution
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Create Institution Modal */}
      {showCreateModal && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000
        }}>
          <div style={{
            backgroundColor: 'white',
            padding: '2rem',
            borderRadius: '0.75rem',
            maxWidth: '600px',
            width: '90%',
            maxHeight: '90vh',
            overflow: 'auto'
          }}>
            <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold', marginBottom: '1rem' }}>
              Add New Institution
            </h2>
            <p style={{ color: '#6b7280', marginBottom: '1.5rem' }}>
              Register a new educational institution to the EcoLearn platform.
            </p>
            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>
              <button
                onClick={() => setShowCreateModal(false)}
                style={{
                  padding: '0.5rem 1rem',
                  border: '1px solid #d1d5db',
                  borderRadius: '0.375rem',
                  backgroundColor: 'white',
                  cursor: 'pointer'
                }}
              >
                Cancel
              </button>
              <button
                style={{
                  padding: '0.5rem 1rem',
                  backgroundColor: '#059669',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer'
                }}
              >
                Create Institution
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Request Detail Modal */}
      {selectedRequest && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1000
        }}>
          <div style={{
            backgroundColor: 'white',
            padding: '2rem',
            borderRadius: '0.75rem',
            maxWidth: '1000px',
            width: '95%',
            maxHeight: '95vh',
            overflow: 'auto'
          }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>
              <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>
                Review Institution Request
              </h2>
              <button
                onClick={() => setSelectedRequest(null)}
                style={{
                  padding: '0.5rem',
                  border: 'none',
                  background: 'none',
                  cursor: 'pointer',
                  fontSize: '1.5rem'
                }}
              >
                <X size={24} />
              </button>
            </div>
            
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '2rem' }}>
              {/* Left Column */}
              <div>
                <h3 style={{ fontSize: '1.125rem', fontWeight: 'bold', marginBottom: '1rem' }}>
                  Institution Information
                </h3>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Institution Name
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.75rem' }}>
                    {selectedRequest.institutionName}
                  </p>
                </div>
                
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1rem' }}>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Type
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.institutionType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                    </p>
                  </div>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Established
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.establishedYear}
                    </p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Address
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.75rem' }}>
                    {selectedRequest.address}
                  </p>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Website
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', marginBottom: '0.75rem' }}>
                    <a href={`https://${selectedRequest.website}`} target="_blank" rel="noopener noreferrer" style={{ color: '#059669', textDecoration: 'underline', display: 'flex', alignItems: 'center', gap: '0.25rem' }}>
                      {selectedRequest.website}
                      <ExternalLink size={12} />
                    </a>
                  </p>
                </div>
                
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1rem' }}>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Students
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.studentCount.toLocaleString()}
                    </p>
                  </div>
                  <div>
                    <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                      Teachers
                    </label>
                    <p style={{ fontSize: '0.875rem', color: '#1f2937' }}>
                      {selectedRequest.teacherCount.toLocaleString()}
                    </p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                    Specializations
                  </label>
                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                    {selectedRequest.specializations.map((spec, index) => (
                      <span
                        key={index}
                        style={{
                          padding: '0.25rem 0.5rem',
                          backgroundColor: '#dbeafe',
                          color: '#1e40af',
                          borderRadius: '0.25rem',
                          fontSize: '0.75rem'
                        }}
                      >
                        {spec}
                      </span>
                    ))}
                  </div>
                </div>
                
                <div style={{ marginBottom: '1rem' }}>
                  <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.25rem', display: 'block' }}>
                    Description
                  </label>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5', marginBottom: '0.75rem' }}>
                    {selectedRequest.description}
                  </p>
                </div>
              </div>
              
              {/* Right Column */}
              <div>
                <h3 style={{ fontSize: '1.125rem', fontWeight: 'bold', marginBottom: '1rem' }}>
                  Contact Information
                </h3>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Principal/President
                  </h4>
                  <div style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    <p>{selectedRequest.principalName}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.principalEmail}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.principalPhone}</p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Primary Contact
                  </h4>
                  <div style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    <p>{selectedRequest.contactPersonName}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.contactPersonRole}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.contactPersonEmail}</p>
                    <p style={{ color: '#6b7280' }}>{selectedRequest.contactPersonPhone}</p>
                  </div>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Accreditations
                  </h4>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    {selectedRequest.accreditations}
                  </p>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Previous Platforms
                  </h4>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    {selectedRequest.previousPlatforms}
                  </p>
                </div>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Expectations
                  </h4>
                  <p style={{ fontSize: '0.875rem', color: '#1f2937', lineHeight: '1.5' }}>
                    {selectedRequest.expectations}
                  </p>
                </div>
                
                <div>
                  <h4 style={{ fontSize: '1rem', fontWeight: '500', marginBottom: '0.5rem' }}>
                    Uploaded Documents ({selectedRequest.documents.length})
                  </h4>
                  <div style={{ space: '0.5rem' }}>
                    {selectedRequest.documents.map(doc => (
                      <div key={doc.id} style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'space-between',
                        padding: '0.75rem',
                        backgroundColor: '#f9fafb',
                        border: '1px solid #e5e7eb',
                        borderRadius: '0.5rem',
                        marginBottom: '0.5rem'
                      }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                          <FileText size={20} style={{ color: '#6b7280' }} />
                          <div>
                            <div style={{ fontSize: '0.875rem', color: '#1f2937', fontWeight: '500' }}>
                              {doc.name}
                            </div>
                            <div style={{ fontSize: '0.75rem', color: '#6b7280' }}>
                              {formatFileSize(doc.size)}
                            </div>
                          </div>
                        </div>
                        <button
                          style={{
                            padding: '0.25rem 0.5rem',
                            backgroundColor: '#059669',
                            color: 'white',
                            border: 'none',
                            borderRadius: '0.25rem',
                            cursor: 'pointer',
                            fontSize: '0.75rem'
                          }}
                        >
                          View
                        </button>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
            
            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end', marginTop: '2rem', paddingTop: '1rem', borderTop: '1px solid #e5e7eb' }}>
              <button
                onClick={() => setSelectedRequest(null)}
                style={{
                  padding: '0.75rem 1.5rem',
                  border: '1px solid #d1d5db',
                  borderRadius: '0.375rem',
                  backgroundColor: 'white',
                  cursor: 'pointer',
                  color: '#374151'
                }}
              >
                Close
              </button>
              <button
                onClick={() => {
                  const currentRequest = selectedRequest;
                  setSelectedRequest(null);
                  handleRejectRequest(currentRequest);
                }}
                style={{
                  padding: '0.75rem 1.5rem',
                  backgroundColor: '#dc2626',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <ThumbsDown size={16} />
                Reject Request
              </button>
              <button
                onClick={() => {
                  const currentRequest = selectedRequest;
                  setSelectedRequest(null);
                  handleApproveRequest(currentRequest);
                }}
                style={{
                  padding: '0.75rem 1.5rem',
                  backgroundColor: '#059669',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <ThumbsUp size={16} />
                Approve Request
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Approval Confirmation Modal */}
      {showApprovalModal && selectedRequest && (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          backgroundColor: 'rgba(0,0,0,0.5)',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          zIndex: 1001
        }}>
          <div style={{
            backgroundColor: 'white',
            padding: '2rem',
            borderRadius: '0.75rem',
            maxWidth: '500px',
            width: '90%'
          }}>
            <div style={{ textAlign: 'center', marginBottom: '1.5rem' }}>
              <div style={{
                width: '4rem',
                height: '4rem',
                backgroundColor: approvalAction === 'approve' ? '#dcfce7' : '#fee2e2',
                borderRadius: '50%',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                margin: '0 auto 1rem'
              }}>
                {approvalAction === 'approve' ? (
                  <Check size={32} style={{ color: '#166534' }} />
                ) : (
                  <X size={32} style={{ color: '#991b1b' }} />
                )}
              </div>
              
              <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#1f2937', marginBottom: '0.5rem' }}>
                {approvalAction === 'approve' ? 'Approve Institution Request' : 'Reject Institution Request'}
              </h2>
              
              <p style={{ color: '#6b7280' }}>
                Are you sure you want to {approvalAction} the request from <strong>{selectedRequest.institutionName}</strong>?
              </p>
            </div>
            
            {approvalAction === 'approve' && (
              <div style={{ 
                backgroundColor: '#f0f9ff', 
                padding: '1rem', 
                borderRadius: '0.5rem',
                marginBottom: '1.5rem'
              }}>
                <h4 style={{ fontSize: '0.875rem', fontWeight: '500', color: '#1f2937', marginBottom: '0.5rem' }}>
                  What happens next:
                </h4>
                <ul style={{ fontSize: '0.875rem', color: '#6b7280', lineHeight: '1.5', paddingLeft: '1rem' }}>
                  <li>Institution will be added to the platform</li>
                  <li>Admin credentials will be sent to the primary contact</li>
                  <li>Access will be granted based on subscription tier</li>
                  <li>Onboarding materials will be provided</li>
                </ul>
              </div>
            )}
            
            {approvalAction === 'reject' && (
              <div style={{ marginBottom: '1.5rem' }}>
                <label style={{ fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem', display: 'block' }}>
                  Rejection Reason (optional)
                </label>
                <textarea
                  placeholder="Provide a reason for rejection..."
                  rows={3}
                  style={{
                    width: '100%',
                    padding: '0.75rem',
                    border: '1px solid #d1d5db',
                    borderRadius: '0.5rem',
                    fontSize: '0.875rem',
                    fontFamily: 'inherit',
                    resize: 'vertical'
                  }}
                />
              </div>
            )}
            
            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>
              <button
                onClick={() => setShowApprovalModal(false)}
                style={{
                  padding: '0.75rem 1.5rem',
                  border: '1px solid #d1d5db',
                  borderRadius: '0.375rem',
                  backgroundColor: 'white',
                  cursor: 'pointer',
                  color: '#374151'
                }}
              >
                Cancel
              </button>
              <button
                onClick={confirmApproval}
                style={{
                  padding: '0.75rem 1.5rem',
                  backgroundColor: approvalAction === 'approve' ? '#059669' : '#dc2626',
                  color: 'white',
                  border: 'none',
                  borderRadius: '0.375rem',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                {approvalAction === 'approve' ? (
                  <>
                    <Check size={16} />
                    Confirm Approval
                  </>
                ) : (
                  <>
                    <X size={16} />
                    Confirm Rejection
                  </>
                )}
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default InstitutionManagement;